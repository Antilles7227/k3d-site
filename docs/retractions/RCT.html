<!DOCTYPE html>
<!--
Copyright 2018 The Go Authors. All rights reserved.
Use of this source code is governed by a BSD-style
license that can be found in the LICENSE file.
-->
<html>

<head>
  <meta charset="utf-8" />
  <title>Генератор G-code для калибровки откатов</title>
  <script src="lib.js"></script>
  <script src="wasm_exec.js"></script>
  <script src="gwaloader.js"></script>
  <body onload="addFormFieldChangeHandler()"></body>
</head>

<body>
  <h1>Генератор G-code для калибровки откатов</h1>
  <p></p>
  <table>
    <tbody>
      <tr>
        <td>Параметр</td>
        <td>Значение</td>
        <td>Описание</td>
      </tr>
      <tr>
        <td>Размер стола по X</td>
        <td><input type="text" id="bedX" name="BedX" value="235"></td>
        <td>[мм] Максимальная координата по X</td>
      </tr>
      <tr>
        <td>Размер стола по Y</td>
        <td><input type="text" id="bedY" name="BedY" value="235"></td>
        <td>[мм] Максимальная координата по Y</td>
      </tr>
      <tr>
        <td>Автокалибровка стола</td>
        <td><input type="checkbox" id="bedProbe" name="bedProbe"></td>
        <td>Надо ли делать автокалибровку стола перед печатью? Если у вас нет датчика автокалибровки, то оставляйте
          выключенным</td>
      </tr>
      <tr>
        <td>Температура хотэнда</td>
        <td><input type="text" id="hotendTemperature" name="hotendTemperature" value="210"></td>
        <td>[°C]Температура, до которой нагреть хотэнд перед печатью</td>
      </tr>
      <tr>
        <td>Температура стола</td>
        <td><input type="text" id="bedTemperature" name="bedTemperature" value="60"></td>
        <td>[°C]Температура, до которой нагреть стол перед печатью</td>
      </tr>
      <tr>
        <td>Ширина линии</td>
        <td><input type="text" id="lineWidth" name="lineWidth" value="0.4"></td>
        <td>[мм] Ширина линий, с которой будут напечатаны башенки</td>
      </tr>
      <tr>
        <td>Ширина линии первого слоя</td>
        <td><input type="text" id="firstLayerLineWidth" name="firstLayerLineWidth" value="0.6"></td>
        <td>[мм] Ширина линий, с которой будет напечатана подложка под башенками</td>
      </tr>
      <tr>
        <td>Толщина слоя</td>
        <td><input type="text" id="layerHeight" name="layerHeight" value="0.25"></td>
        <td>[мм] Толщина слоёв всей модели</td>
      </tr>
      <tr>
        <td>Скорость печати</td>
        <td><input type="text" id="printSpeed" name="printSpeed" value="60"></td>
        <td>[мм/с] Скорость, с которой будут напечатаны башенки</td>
      </tr>
      <tr>
        <td>Скорость печати первого слоя</td>
        <td><input type="text" id="firstLayerPrintSpeed" name="firstLayerPrintSpeed" value="30"></td>
        <td>[мм/с] Скорость, с которой будет напечатана подложка под башенки</td>
      </tr>
      <tr>
        <td>Скорость перемещений</td>
        <td><input type="text" id="travelSpeed" name="travelSpeed" value="150"></td>
        <td>[мм/с] Скорость перемещений между башенками</td>
      </tr>
      <tr>
        <td>Начальная длина отката</td>
        <td><input type="text" id="initRetractLength" name="initRetractLength" value="2.0"></td>
        <td>[мм] Длина отката, с которой будет напечатан нижний сегмент</td>
      </tr>
      <tr>
        <td>Изменение отката за сегмент</td>
        <td><input type="text" id="retractLengthDelta" name="retractDelta" value="0.2"></td>
        <td>[мм] Изменении длины отката для каждого последующего сегмента. К примеру, если первый сегмент напечатан с
          откатом 2мм, а изменение отката за сегмент 0.2мм, то второй сегмент будет 1.8мм, третий 1.6мм и т.д.</td>
      </tr>
      <tr>
        <td>Начальная скорость отката</td>
        <td><input type="text" id="initRetractSpeed" name="initRetractSpeed" value="30"></td>
        <td>[мм/с] Скорость, с которой будут выполняться откаты</td>
      </tr>
      <tr>
        <td>Изменение скорости отката за сегмент</td>
        <td><input type="text" id="retractSpeedDelta" name="retractSpeedDelta" value="0"></td>
        <td>[мм/с] Изменение скорости отката для каждого последующего сегмента. Если хотите, чтобы скорость отката не
          менялась, то укажите 0</td>
      </tr>
      <tr>
        <td>Количество сегментов</td>
        <td><input type="text" id="numSegments" name="numSegments" value="10"></td>
        <td>Количество сегментов башенки. В течение сегмента длина и скорость отката остаются неизменными</td>
      </tr>
      <tr>
        <td>Высота сегмента</td>
        <td><input type="text" id="segmentHeight" name="segmentHeight" value="5"></td>
        <td>[мм] Высота одного сегмента башенки. К примеру, если высота сегмента 5мм, а количество сегментов 10, то
          высота
          всей башенки будет 50мм</td>
      </tr>
      <tr>
        <td>k-фактор Linear Advance</td>
        <td><input type="text" id="kFactor" name="kFactor" value="M900 K0.0"></td>
        <td>Впишите команду, которую ваша прошивка использует для выставления k-фактора Linear/Pressure Advance. Для
          Marlin это 'M900 K(значение)', для Klipper 'SET_PRESSURE_ADVANCE ADVANCE=(значение)', для RRF 'M572 D0
          S(значение)'. Если вы не пользуетесь Linear/Pressure Advance, то оставьте поле пустым</td>
      </tr>
    </tbody>
  </table>
  <button onClick="check();" id="checkButton">Проверить</button><br>
  <button onClick="generate();" id="generateButton" disabled>Генерировать код</button>
  <div id="resultContainer"></div>
</body>
</html>